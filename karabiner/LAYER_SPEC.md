# Karabiner レイヤー仕様書
*Vialベースの設計思想を取り入れたホームロウ修飾キー + レイヤーシステム*

## 設計コンセプト
### ホームロウ修飾キー（Home Row Mods）
- **効率性**: 手の移動を最小限に抑えた修飾キー配置
- **エルゴノミクス**: 左右の手でバランスよく修飾キーを分散
- **学習性**: 直感的で覚えやすいキー配置

### レイヤーシステム
- **Layer-0**: ベース + ホームロウ修飾キー
- **Layer-1**: 数字・記号（テンキー風配列）
- **Layer-2**: マウス・ナビゲーション（Vim風 + マウス制御）

## レイヤートリガー
- **Space**: Layer-1をアクティベート（単体押しでスペース）
- **英数 (japanese_eisuu)**: Layer-2をアクティベート（単体押しで英数）

## Layer-0 (Default)

### ホームロウ修飾キー（Vial準拠・レイヤー非アクティブ時のみ）
| キー | 機能 | 説明 |
|------|------|------|
| **左手** |||
| Q | 長押し→Left Alt、短押し→Q | ホームロウ修飾キー |
| A | 長押し→Right Control、短押し→A | ホームロウ修飾キー |
| S | 長押し→Left Command、短押し→S | ホームロウ修飾キー |
| Z | 長押し→Left Shift、短押し→Z | ホームロウ修飾キー |
| **右手** |||
| F | 長押し→Right Control、短押し→F | ホームロウ修飾キー |
| G | 長押し→Left Command、短押し→G | ホームロウ修飾キー |
| V | 長押し→Left Shift、短押し→V | ホームロウ修飾キー |

### Apple内蔵キーボード専用
- **Left Control** → Right Command
- **Left Command** → Left Option
- **Left Option** → Left Control

### 全キーボード共通

## Layer-1 (Numbers & Symbols)
**トリガー**: Space長押し

| キー | 機能 | 説明 |
|------|------|------|
| **上段** |||
| Q | ` | バッククォート（grave） |
| W | 7 | テンキー上段左 |
| E | 8 | テンキー上段中 |
| R | 9 | テンキー上段右 |
| T | ' | シングルクォート |
| Y | ' | シングルクォート |
| U | 7 | テンキー（重複） |
| I | 8 | テンキー（重複） |
| O | 9 | テンキー（重複） |
| P | 0 | ゼロ |
| **中段（ホーム行）** |||
| A | - | ハイフン・マイナス |
| S | 4 | テンキー中段左 |
| D | 5 | テンキー中段中 |
| F | 6 | テンキー中段右 |
| G | [ | 開き角括弧 |
| H | ] | 閉じ角括弧 |
| J | 4 | テンキー（重複） |
| K | 5 | テンキー（重複） |
| L | 6 | テンキー（重複） |
| ; | △ | 下位レイヤー透過 |
| **下段** |||
| Z | = | イコール |
| X | 1 | テンキー下段左 |
| C | 2 | テンキー下段中 |
| V | 3 | テンキー下段右 |
| B | 0 | ゼロ |
| N | ' | シングルクォート |
| M | 1 | テンキー（重複） |
| , | 2 | テンキー（重複） |
| . | 3 | テンキー（重複） |
| / | ` | バッククォート（重複） |

## Layer-2 (Mouse & Navigation)
**トリガー**: 英数長押し

| キー | 機能 | 説明 |
|------|------|------|
| **上段** |||
| Q | Left Command | Command修飾キー |
| W | 水平スクロール左 | マウス横スクロール |
| E | 垂直スクロール下 | マウス縦スクロール |
| R | 水平スクロール右 | マウス横スクロール |
| T | マウス進む(Button5) | ブラウザ進む |
| Y | Home | 行頭移動 |
| U | Page Down | ページダウン |
| I | Page Up | ページアップ |
| O | End | 行末移動 |
| P | Insert | 挿入キー |
| **中段（ホーム行）** |||
| A | - | ハイフン |
| S | Enter | 改行・決定 |
| D | 垂直スクロール上 | マウス縦スクロール |
| F | 左クリック(Button1) | マウス左クリック |
| G | 右クリック(Button3) | マウス右クリック |
| H | ← | 左矢印（Vim風） |
| J | ↓ | 下矢印（Vim風） |
| K | ↑ | 上矢印（Vim風） |
| L | → | 右矢印（Vim風） |
| ; | △ | 下位レイヤー透過 |
| **下段** |||
| Z | Left Control | Control修飾キー |
| X | Backspace | 後退削除 |
| C | Delete | 前進削除 |
| V | 中クリック(Button2) | マウス中クリック |
| B | マウス戻る(Button4) | ブラウザ戻る |
| N | Enter | 改行 |
| M | Space | スペース |
| , | Backspace | 後退削除 |
| . | Delete | 前進削除 |
| / | Caps Lock | 大文字ロック |

## Layer-3 (Application Control)
**トリガー**: 無変換 (japanese_kana) 長押し

| キー | 機能 | 説明 |
|------|------|------|
| **上段** |||
| Q | Cmd+Q | アプリ終了 |
| W | Cmd+W | ウィンドウ閉じる |
| E | Cmd+E | Spotlight検索 |
| R | Cmd+R | リロード・更新 |
| T | Cmd+T | 新しいタブ |
| Y | Cmd+Y | やり直し |
| U | Cmd+Shift+[ | 前のタブ |
| I | Cmd+Shift+] | 次のタブ |
| O | Cmd+O | ファイルを開く |
| P | Cmd+P | 印刷 |
| **中段（ホーム行）** |||
| A | Cmd+A | 全選択 |
| S | Cmd+S | 保存 |
| D | Cmd+D | 複製・お気に入り追加 |
| F | Cmd+F | 検索 |
| G | Cmd+G | 次を検索 |
| H | Cmd+H | ウィンドウを隠す |
| J | Ctrl+↓ | 下の仮想デスクトップ |
| K | Ctrl+↑ | 上の仮想デスクトップ |
| L | Cmd+L | アドレスバーにフォーカス |
| ; | △ | 下位レイヤー透過 |
| **下段** |||
| Z | Cmd+Z | 元に戻す |
| X | Cmd+X | 切り取り |
| C | Cmd+C | コピー |
| V | Cmd+V | 貼り付け |
| B | Cmd+B | ブックマーク |
| N | Cmd+N | 新規作成 |
| M | Cmd+M | ウィンドウを最小化 |
| , | Cmd+, | 環境設定 |
| . | F11 | フルスクリーン |
| / | Cmd+/ | ヘルプ |

## 特殊設定

### Parallels対応（RDP & Input Switching）
Parallelsアプリ使用時のみ：
- Left Command ↔ Left Control入れ替え
- Right Command ↔ Right Control入れ替え
- Right Control + Q → Alt + F4

### G600マウス設定
G600マウス（vendor_id: 1133, product_id: 49738）使用時：
- Keypad 1 → Home
- Keypad 2 → ↑
- Keypad 3 → End
- Keypad 4 → ←
- Keypad 5 → ↓
- Keypad 6 → →
- Keypad 9 → Option + ←（単語移動）
- Keypad 0 → Cmd + Shift + S

## 使用上の注意

### ホームロウ修飾キーのコツ
1. **短いタップ**: 通常のキー入力（Q, A, Z, S, F, G, V）
2. **長押し**: 修飾キーとして機能（200ms以上の長押し）
3. **修飾キー透過**: レイヤー内でも既存の修飾キーが動作

### 学習の段階
1. **第1段階**: Layer-0のホームロウ修飾キーに慣れる
2. **第2段階**: Layer-1のテンキー配列をマスター
3. **第3段階**: Layer-2のマウス・ナビゲーション機能を活用

## 今後の拡張予定

### Layer-3の検討
- **アプリケーション制御**: ウィンドウ管理、仮想デスクトップ
- **メディア制御**: 音量、再生/停止、トラック切り替え
- **システム機能**: スクリーンショット、通知センター

### 機能改良
- **マクロ機能**: よく使う文字列の自動入力
- **コンボキー**: 複数キー同時押しでの特殊機能
- **タップダンス**: 同じキーの連続タップで異なる機能

この仕様書を基に、段階的にKarabiner設定を実装・改良していきます。